<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Step-by-Step Search Visualizer</title>
  <style>
    /* Overall Page Styling */
    body {
      font-family: Arial, sans-serif;
      background: #F5F5F5; /* Light soothing background */
      color: #333;
      text-align: center;
      padding: 20px;
      max-width: 900px;
      margin: auto;
    }
    h2 {
      margin-bottom: 0.5em;
      color: #607D8B; /* Subtle heading color */
    }

    /* Controls (input + buttons) */
    .controls {
      margin-bottom: 1em;
    }
    input[type="number"] {
      padding: 0.5em;
      width: 120px;
      margin-right: 0.5em;
      border: 1px solid #ccc;
      border-radius: 4px;
      outline: none;
    }
    input[type="number"]:focus {
      border-color: #66afe9;
      box-shadow: 0 0 3px rgba(102,175,233,0.6);
    }
    button {
      padding: 0.5em 1em;
      margin: 0 0.3em;
      cursor: pointer;
      border: none;
      border-radius: 4px;
      background: #2196F3;
      color: #fff;
      transition: background 0.3s ease;
    }
    button:hover {
      background: #1976D2;
    }

    /* Steps Container & Each Step Row */
    .steps-container {
      margin-top: 2em;
      border-top: 2px solid #ccc;
      padding-top: 1em;
    }
    .step-row {
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      padding: 1em;
      margin-bottom: 1.5em;
      text-align: center;
    }

    /* Array Row & Boxes */
    .array-row {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 0.5em;
      flex-wrap: wrap;
    }
    .box {
      width: 40px;
      height: 40px;
      line-height: 40px;
      border: 1px solid #ccc;
      background: #fafafa;
      border-radius: 4px;
      display: inline-block;
      position: relative;
      transition: background 0.3s, transform 0.3s;
    }
    /* Highlight & Found States */
    .box.highlight {
      background: #FFF59D; /* Pastel yellow highlight */
      transform: scale(1.05);
    }
    .box.found {
      background: #4CAF50; /* Green for found */
      color: #fff;
      transform: scale(1.05);
    }

    /* Explanation Text */
    .explanation {
      font-style: italic;
      color: #555;
      margin-top: 0.5em;
    }

    /* Tooltip styling on hover */
    .box[data-title] {
      cursor: help;
    }
    .box[data-title]:hover::after {
      content: attr(data-title);
      position: absolute;
      top: -45px;
      left: 50%;
      transform: translateX(-50%);
      background: #333;
      color: #fff;
      padding: 4px 8px;
      border-radius: 4px;
      white-space: nowrap;
      font-size: 0.8em;
      pointer-events: none;
      z-index: 10;
      opacity: 0.9;
    }

    /* Initial Array Display */
    #initialArray h4 {
      margin-bottom: 0.5em;
      color: #607D8B;
    }
  </style>
</head>
<body>
  <h2>Step-by-Step Search Visualizer</h2>

  <!-- Controls: Input and Buttons -->
  <div class="controls">
    <input type="number" id="searchValue" placeholder="Enter number" />
    <button onclick="showLinearSearch()">Linear Search</button>
    <button onclick="showBinarySearch()">Binary Search</button>
    <button onclick="showTernarySearch()">Ternary Search</button>
  </div>

  <!-- Initial Array Display -->
  <div id="initialArray"></div>

  <!-- Steps Container (algorithm steps appear here) -->
  <div class="steps-container" id="stepsContainer"></div>

  <script>
    // Generate a random sorted array
    const array = Array.from({ length: 10 }, () => Math.floor(Math.random() * 100));
    array.sort((a, b) => a - b);

    const initialArrayDiv = document.getElementById('initialArray');
    const stepsContainer = document.getElementById('stepsContainer');

    // Display the initial array in a single row (for reference)
    function displayInitialArray() {
      const row = document.createElement('div');
      row.className = 'array-row';
      array.forEach(num => {
        const box = document.createElement('div');
        box.className = 'box';
        box.textContent = num;
        row.appendChild(box);
      });
      initialArrayDiv.innerHTML = '<h4>Initial Sorted Array:</h4>';
      initialArrayDiv.appendChild(row);
    }
    displayInitialArray();

    // Clear the steps container before rendering new steps
    function resetSteps() {
      stepsContainer.innerHTML = '';
    }

    // Render an array of step objects
    function renderSteps(steps) {
      resetSteps();
      steps.forEach((step, index) => {
        const stepRow = document.createElement('div');
        stepRow.className = 'step-row';

        // Explanation text
        const explanation = document.createElement('div');
        explanation.className = 'explanation';
        explanation.textContent = `Step ${index + 1}: ${step.explanation}`;
        
        // Array row
        const arrayRow = document.createElement('div');
        arrayRow.className = 'array-row';

        array.forEach((val, idx) => {
          const box = document.createElement('div');
          box.classList.add('box');
          box.textContent = val;

          // Check highlights
          if (step.highlights.includes(idx)) {
            box.classList.add('highlight');
          }
          if (step.foundIndex === idx) {
            box.classList.add('found');
          }

          // Add a tooltip if it's a mid index (or mid1/mid2)
          const midObj = step.midIndexes.find(m => m.index === idx);
          if (midObj) {
            box.setAttribute(
              'data-title',
              `${midObj.label} = ${idx}, Value = ${array[idx]}`
            );
          }

          arrayRow.appendChild(box);
        });

        stepRow.appendChild(arrayRow);
        stepRow.appendChild(explanation);
        stepsContainer.appendChild(stepRow);
      });
    }

    /* 
      Build step arrays for each search
      Each step object: {
        highlights: [indices to highlight],
        foundIndex: index that is found or -1,
        midIndexes: array of {index, label}, e.g. [{index: 3, label: 'mid'}],
        explanation: string describing the step
      }
    */

    // 1) Linear Search
    function linearSearchSteps(arr, value) {
      const steps = [];
      let foundIndex = -1;

      for (let i = 0; i < arr.length; i++) {
        const step = {
          highlights: [i],
          foundIndex: -1,
          midIndexes: [], // No mid concept in linear
          explanation: `Checking index ${i}, value ${arr[i]}`
        };

        if (arr[i] === value) {
          step.foundIndex = i;
          step.explanation += ` — Found ${value} at index ${i}`;
          steps.push(step);
          foundIndex = i;
          break;
        } else {
          step.explanation += ` — Not found here`;
          steps.push(step);
        }
      }

      if (foundIndex === -1) {
        steps.push({
          highlights: [],
          foundIndex: -1,
          midIndexes: [],
          explanation: `Number ${value} not found in array`
        });
      }
      return steps;
    }

    // 2) Binary Search
    function binarySearchSteps(arr, value) {
      let left = 0;
      let right = arr.length - 1;
      const steps = [];
      let foundIndex = -1;

      while (left <= right) {
        const mid = Math.floor((left + right) / 2);

        const step = {
          highlights: [mid], // highlight only mid
          foundIndex: -1,
          midIndexes: [{ index: mid, label: 'mid' }],
          explanation: `Check index ${mid}, value ${arr[mid]}`
        };

        if (arr[mid] === value) {
          step.foundIndex = mid;
          step.explanation += ` — Found ${value} at index ${mid}`;
          steps.push(step);
          foundIndex = mid;
          break;
        } else if (arr[mid] < value) {
          step.explanation += ` — ${value} > ${arr[mid]}, move right`;
          steps.push(step);
          left = mid + 1;
        } else {
          step.explanation += ` — ${value} < ${arr[mid]}, move left`;
          steps.push(step);
          right = mid - 1;
        }
      }

      if (foundIndex === -1) {
        steps.push({
          highlights: [],
          foundIndex: -1,
          midIndexes: [],
          explanation: `Number ${value} not found in array`
        });
      }
      return steps;
    }

    // 3) Ternary Search
    function ternarySearchSteps(arr, value) {
      let left = 0;
      let right = arr.length - 1;
      const steps = [];
      let foundIndex = -1;

      while (left <= right) {
        const third = Math.floor((right - left) / 3);
        const mid1 = left + third;
        const mid2 = right - third;

        const step = {
          highlights: [mid1, mid2],
          foundIndex: -1,
          midIndexes: [
            { index: mid1, label: 'mid1' },
            { index: mid2, label: 'mid2' }
          ],
          explanation: `Check mid1=${mid1} (value ${arr[mid1]}) & mid2=${mid2} (value ${arr[mid2]})`
        };

        if (arr[mid1] === value) {
          step.foundIndex = mid1;
          step.explanation += ` — Found ${value} at mid1`;
          steps.push(step);
          foundIndex = mid1;
          break;
        } else if (arr[mid2] === value) {
          step.foundIndex = mid2;
          step.explanation += ` — Found ${value} at mid2`;
          steps.push(step);
          foundIndex = mid2;
          break;
        } else if (value < arr[mid1]) {
          step.explanation += ` — ${value} < ${arr[mid1]}, search left side`;
          steps.push(step);
          right = mid1 - 1;
        } else if (value > arr[mid2]) {
          step.explanation += ` — ${value} > ${arr[mid2]}, search right side`;
          steps.push(step);
          left = mid2 + 1;
        } else {
          step.explanation += ` — ${value} is between ${arr[mid1]} and ${arr[mid2]}, search middle`;
          steps.push(step);
          left = mid1 + 1;
          right = mid2 - 1;
        }
      }

      if (foundIndex === -1) {
        steps.push({
          highlights: [],
          foundIndex: -1,
          midIndexes: [],
          explanation: `Number ${value} not found in array`
        });
      }
      return steps;
    }

    // Button Click Handlers
    function showLinearSearch() {
      const value = parseInt(document.getElementById('searchValue').value);
      if (isNaN(value)) {
        alert('Please enter a valid number!');
        return;
      }
      const steps = linearSearchSteps(array, value);
      renderSteps(steps);
    }

    function showBinarySearch() {
      const value = parseInt(document.getElementById('searchValue').value);
      if (isNaN(value)) {
        alert('Please enter a valid number!');
        return;
      }
      const steps = binarySearchSteps(array, value);
      renderSteps(steps);
    }

    function showTernarySearch() {
      const value = parseInt(document.getElementById('searchValue').value);
      if (isNaN(value)) {
        alert('Please enter a valid number!');
        return;
      }
      const steps = ternarySearchSteps(array, value);
      renderSteps(steps);
    }
  </script>
</body>
</html>
